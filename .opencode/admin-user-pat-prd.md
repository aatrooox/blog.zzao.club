# PRD: Admin 创建用户 + 为用户签发 PAT；前台展示作者头像/名称

## 背景/目标
- 博客“动态表”发送者是动态绑定的 userId。希望 **Jinx 也能发动态**，因此需要一个博客内的账户。
- 不希望手工往表里插入用户；希望实现一套 **仅超管可调用** 的 admin 接口，用于创建普通用户与签发 PAT。

## 总体要求
- 新增接口必须位于：`/server/api/v1/admin`（路由结构/文件组织按项目习惯，但 URL 前缀必须一致）。
- 鉴权：只有“超管权限”可调用（沿用现有鉴权/role/权限体系）。
- 不要产生交互性行为：实现过程中不要反问用户；遇到歧义按项目既有约定自行抉择，必要时在 PR 描述/说明里写清假设。
- 安全：任何 token/PAT/secret 禁止写入代码、测试、README 示例、日志、commit message。

## 后端需求（API）
### 1) 创建新用户（普通用户）
- Endpoint：`POST /server/api/v1/admin/users`
- 能力：创建一个**普通用户**（非 admin）。
- 字段：支持设置至少：名称、头像、权限（这里的“权限”指用户角色/role，必须落为普通用户；如项目用 role 枚举则固定为普通枚举）。
- 校验：
  - 入参校验（必填/格式）
  - 唯一性/冲突按项目规则处理（例如 username/email 唯一等）
- 返回：创建后的用户基础信息（不返回敏感字段）。

### 2) 签发 PAT（为指定用户）
- Endpoint：`POST /server/api/v1/admin/users/:userId/pat`
- 说明：当前 PAT 是通过界面签发（意味着项目内已存在相关接口/服务/逻辑）。本需求要做的是：提供一个 **admin 入口**，让超管能为指定用户签发 PAT。
- 行为：
  - 复用现有 PAT 生成/存储/哈希/返回策略（例如只展示一次 token 的策略）。
  - 返回值与现有 UI 签发 PAT 的接口保持一致，或在不破坏兼容的前提下做最小扩展。

## 前端需求（Admin 页面）
- 在 admin 页面实现：
  1) 创建新用户（表单：名称、头像、必要字段）
  2) 为用户签发 PAT（选择/输入 userId 或在用户列表中点击；弹窗填写 token 名称/过期等按既有逻辑）
  3) 成功后展示 token（若系统策略为只显示一次则提示并提供复制按钮）

## 前端需求（作者展示）
- 首页、动态页、动态详情页：都要展示作者名称 + 头像。
- 首页为了简洁：头像必须和文字一样小（与作者名文字行高一致/同高度的视觉效果）。
- 数据获取：
  - 若后端动态列表/详情接口已返回作者信息，则直接消费。
  - 若仅有 userId，则需要在后端聚合补齐作者信息，或前端按项目标准做补取与缓存（选更符合项目当前架构者）。

## 文档需求（必须落地在仓库 docs/ 或项目约定的位置）
1) 如何创建一个博客新用户（用于未来增加更多创作者）
2) 如何为新用户签发 PAT，并让其用自己的身份调用博客接口

## 验收标准
- 超管可以通过 admin API 创建普通用户；创建后 role=普通用户；返回不含敏感信息。
- 超管可以为指定 userId 签发 PAT；得到的 token 可用于调用需要鉴权的博客接口（以该用户身份）。
- 非超管调用 admin API 会被拒绝（401/403 按项目规范）。
- 首页/动态页/动态详情页均展示作者头像+名称；首页作者头像尺寸符合“和文字一样小”。
- 文档两篇齐全、按文档可复现。

## 交付物（opencode 完成后必须输出）
- 改动摘要（按后端/前端/文档）
- 变更文件列表
- 本地验证步骤（至少 smoke：启动、创建用户、签发 PAT、页面展示）
- 敏感信息自查结果（确认无 token/PAT 进入 git）
